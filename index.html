<html>
    <head>
        <title>Billboard Chart Visualization</title>
        <script type="text/javascript" src="d3.v2.min.js"></script>
		<style type="text/css">
            body{
                background-color: white;
            }

            .arc{
                stroke: #eee;
                background-color: white;
            }
		</style>
    </head>
    <body>
        <script type="text/javascript">
            var width = 1300,
                height = 1000,
                radius = Math.min(width, height) / 2,
                colorScale = d3.scale.category20c();    

            var band_width = 8;
            var gap = 2;
            var years = 23;
            var num_artists = 47;
            var angle = 2*Math.PI/(years+1);
            console.log("the angle is"+angle);

            var vis = d3.select("body").append("svg")
                         .attr("width", width)
                         .attr("height", height)
                      .append("svg:g")
                         .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

            var arc = d3.svg.arc()
            .startAngle(function(d, i){
                console.log("track   " + d.Track +"  " + (d.Year - 1990)*angle);
                return (d.Year - 1990 + 1)*angle;
            })
            .endAngle(function(d, i){
                return (d.Year - 1991 + 1)*angle;
            })
            .innerRadius(function(d, i){  
                return (gap + band_width) * (num_artists -1 - d.LastRank) + gap;
            })
            .outerRadius(function(d, i){
                return (gap + band_width) * (num_artists - d.LastRank);
            });

            d3.json("chart-data.json", function(json){
                vis.selectAll(".arc")
                    .data(json)
                    .enter()
                    .append("path")
                    .attr("class", "arc")
                    .attr("fill", "#FF2240")
                    .attr("opacity", function(d){
                        return (1 - d.High/100);
                    })
                    .attr("d", arc)
                    .on('mouseover', function(){return d3.select(this).attr('stroke-width', 4)})
                    .on('mouseout', function(){return d3.select(this).attr('stroke-width', 0)})
                    .on('click', function(d, i){ window.location.href = "artist.html?query="+d.Artist });
            });


        </script>
    </body>
</html>